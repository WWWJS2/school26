<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap');

    :root{
      --primary:#10b981;
      --secondary:#059669;
      --dark:#047857;
      --light:#d1fae5;
      --accent:#fbbf24;
      --lab-color:#8b5cf6;
      --lab-dark:#7c3aed;
      --lab-light:#ede9fe;
      --text:#0f172a;
      --gray:#475569;
      --container:94vw;
      --card-bg:#ffffff;
      --shadow:0 4px 12px rgba(16,185,129,.1);
    }

    *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
    html, body{
      font-family:'Tajawal',sans-serif;
      background:linear-gradient(135deg,#f0fdf4 0%,#dcfce7 50%,#f0fdf4 100%);
      color:var(--text);
      line-height:1.65;
      min-height:100vh;
      overflow-x:hidden;
      font-size:16px;
    }

    .header-logo{
      background:#fff;
      position:sticky;
      top:0;
      z-index:1000;
      box-shadow:0 4px 12px rgba(16,185,129,.1);
      border-bottom:2px solid var(--light);
      padding:8px 0;
    }
    .header-logo .wrap{
      width:var(--container);
      max-width:1200px;
      margin:0 auto;
      padding:0 12px;
      display:flex;
      justify-content:center;
      align-items:center;
      flex-direction:column;
    }
    .header-logo img{height:84px;width:auto;object-fit:contain;}
    .header-text{text-align:center;margin-top:10px;}
    .header-text h1{color:var(--dark);font-size:1.8rem;margin-bottom:5px;}
    .header-text p{color:var(--gray);font-size:1rem;}
    .quran-verse{margin-top:10px;font-size:1.1rem;font-weight:500;color:var(--dark);}

    nav{
      background:linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      padding: 15px 0;
      box-shadow: 0 4px 12px rgba(16,185,129,.2);
    }
    .nav-container{width:var(--container);max-width:1200px;margin:0 auto;padding:0 12px;}
    .nav-title{color:#fff;text-align:center;margin-bottom:15px;font-size:1.3rem;font-weight:700;}
    .cards-container{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
      gap:18px;
    }
    .card{
      background:var(--card-bg);
      border-radius:12px;
      padding:18px;
      box-shadow:var(--shadow);
      transition:all .25s;
      cursor:pointer;
      border:1px solid rgba(0,0,0,.04);
      text-align:center;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
    }
    .card:hover{transform:translateY(-4px);box-shadow:0 10px 20px rgba(0,0,0,.15);}
    .card .icon{
      font-size:2.2rem;
      width:62px;height:62px;
      display:flex;align-items:center;justify-content:center;
      border-radius:999px;
      background:rgba(16,185,129,.08);
      color:var(--primary);
      margin-bottom:4px;
    }
    .card .title{font-size:1.05rem;font-weight:800;color:var(--dark);}
    .card .subtitle{font-size:.8rem;color:#6b7280;display:flex;flex-wrap:wrap;gap:6px;justify-content:center;}
    .card .subtitle span{
      background:#e5e7eb;
      padding:3px 9px;
      border-radius:999px;
      font-size:.75rem;
    }
    .card.featured{border-top:3px solid var(--accent);}
    .card.labs{border-top:3px solid var(--lab-color);}
    .card.labs .icon{background:rgba(139,92,246,.12);color:var(--lab-color);}

    #iframe-container{width:100%;height:80vh;display:none;margin-top:20px;padding:0 1rem;}
    #content-frame{width:100%;height:100%;border-radius:12px;box-shadow:var(--shadow);border:none;}

    #local-pages{width:100%;max-width:1200px;margin:20px auto 40px;padding:0 1rem 80px;display:none;}
    .card-page{
      background:linear-gradient(135deg,#ffffff 0%,#ecfdf5 100%);
      padding:22px;
      border-radius:18px;
      box-shadow:0 10px 30px rgba(15,118,110,.12);
    }
    .wait-intro,.lab-intro,.general-intro{
      text-align:center;
      color:var(--gray);
      font-size:.95rem;
      margin-bottom:18px;
    }

    .form{display:grid;gap:14px;}
    .grid-3{display:grid;grid-template-columns:1fr;gap:10px;}
    @media (min-width:768px){.grid-3{grid-template-columns:repeat(3,1fr);}}

    label{display:flex;flex-direction:column;gap:6px;color:var(--text);font-weight:600;font-size:.88rem;}
    .input,textarea,select{
      width:100%;
      padding:9px 11px;
      border-radius:10px;
      border:2px solid #bbf7d0;
      background:#fefdf9;
      font-family:'Tajawal',sans-serif;
      font-size:.95rem;
      transition:all .2s;
      color:var(--text);
    }

    /* âœ… Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙˆØ¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø·ÙˆÙŠÙ„Ø© (Ø®ØµÙˆØµÙ‹Ø§ iPhone) */
    textarea{
      min-height:90px;
      resize:vertical;
      direction:rtl;
      text-align:right;
      unicode-bidi:plaintext;
      white-space:pre-wrap;
      word-break:break-word;
      overflow-wrap:anywhere;
      line-height:1.9;
    }

    .input:focus,textarea:focus,select:focus{
      outline:none;border-color:var(--primary);
      box-shadow:0 0 0 3px rgba(16,185,129,.18);
      background:#fff;
    }
    .lab-form .input,.lab-form textarea{border-color:var(--lab-light);}
    .lab-form .input:focus,.lab-form textarea:focus{
      border-color:var(--lab-color);
      box-shadow:0 0 0 3px rgba(139,92,246,.18);
    }

    .chipset{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px;}
    .chip{
      display:flex;align-items:center;gap:6px;
      background:linear-gradient(135deg,#ecfdf5,#dcfce7);
      padding:7px 10px;border-radius:999px;
      border:1px solid #bbf7d0;
      font-size:.82rem;cursor:pointer;transition:all .2s;
    }
    .chip input{width:15px;height:15px;accent-color:var(--primary);cursor:pointer;}
    .chip:hover{transform:translateY(-1px);box-shadow:0 4px 10px rgba(16,185,129,.25);}

    .actions{display:flex;flex-direction:column;gap:8px;margin-top:6px;}
    @media (min-width:768px){.actions{flex-direction:row;}}
    .btn{
      border:none;border-radius:14px;
      padding:9px 16px;font-weight:800;font-size:.9rem;
      cursor:pointer;
      background:linear-gradient(135deg,var(--primary),var(--secondary));
      color:#fff;
      box-shadow:0 4px 15px rgba(16,185,129,.4);
      transition:all .2s;
      width:100%;text-align:center;
    }
    .btn:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(16,185,129,.5);}
    .btn:active{transform:scale(.98);}
    .btn.danger{background:linear-gradient(135deg,#ef4444,#b91c1c);box-shadow:0 4px 15px rgba(185,28,28,.4);}
    .btn:disabled{opacity:.65;cursor:not-allowed;transform:none;}

    .lab-form .btn{
      background:linear-gradient(135deg,var(--lab-color),var(--lab-dark));
      box-shadow:0 4px 15px rgba(139,92,246,.4);
    }

    .date-with-hijri{position:relative;}
    .date-input-container{position:relative;display:flex;align-items:center;}
    .date-input-container .input{padding-right:44px;cursor:pointer;}
    .hijri-toggle{
      position:absolute;left:7px;top:50%;transform:translateY(-50%);
      background:transparent;border:none;cursor:pointer;
      width:28px;height:28px;border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      transition:all .2s;
    }
    .hijri-toggle:hover{background:rgba(16,185,129,.12);}
    .hijri-icon{width:18px;height:18px;fill:var(--dark);}
    .hijri-calendar{
      position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
      background:#fff;border-radius:14px;
      box-shadow:0 10px 30px rgba(15,118,110,.2);
      padding:12px;z-index:1500;width:90vw;max-width:320px;
      border:2px solid #bbf7d0;display:none;
    }
    .hijri-calendar.active{display:block;animation:fadeIn .25s ease;}
    .hijri-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid #e5e7eb;}
    .hijri-month-year{font-weight:700;color:var(--dark);font-size:.95rem;}
    .hijri-nav{display:flex;gap:4px;}
    .hijri-nav button{
      background:#ecfdf5;border:none;border-radius:6px;
      padding:3px 7px;cursor:pointer;font-size:.75rem;
      font-weight:700;color:var(--dark);transition:all .2s;
    }
    .hijri-nav button:hover{background:var(--primary);color:#fff;}
    .hijri-weekdays{
      display:grid;grid-template-columns:repeat(7,1fr);
      text-align:center;font-weight:700;color:var(--dark);
      font-size:.75rem;margin-bottom:4px;
    }
    .hijri-days{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;}
    .hijri-day{
      padding:6px 2px;text-align:center;border-radius:6px;
      cursor:pointer;font-size:.78rem;color:var(--text);
      transition:all .2s;
    }
    .hijri-day:hover{background:#ecfdf5;}
    .hijri-day.selected{background:var(--primary);color:#fff;}
    .today-btn{
      margin-top:8px;width:100%;padding:7px 10px;
      border:none;border-radius:8px;cursor:pointer;
      font-weight:700;font-size:.8rem;
      background:#ecfdf5;color:var(--dark);
      transition:all .2s;
    }
    .today-btn:hover{background:var(--primary);color:#fff;}

    .wait-subtitle,.lab-subtitle,.general-subtitle{
      margin-top:20px;margin-bottom:8px;font-size:1.05rem;
      color:var(--dark);font-weight:800;border-right:4px solid var(--accent);
      padding-right:8px;
    }
    .lab-subtitle{border-right-color:var(--lab-color);color:var(--lab-dark);}
    .general-subtitle{border-right-color:#0ea5e9;color:#075985;}

    .table-wrap{
      margin-top:8px;border-radius:12px;overflow:hidden;
      box-shadow:0 6px 18px rgba(15,118,110,.12);
      overflow-x:auto;background:#fff;
    }
    table{width:100%;border-collapse:collapse;min-width:750px;font-size:.8rem;}
    th,td{padding:8px 6px;border-bottom:1px solid #e5e7eb;text-align:center;vertical-align:top;}
    th{
      background:linear-gradient(135deg,var(--primary),var(--secondary));
      color:#fff;font-weight:800;font-size:.78rem;white-space:nowrap;
    }
    .lab-table th{background:linear-gradient(135deg,var(--lab-color),var(--lab-dark));}
    .general-table th{background:linear-gradient(135deg,#0ea5e9,#0369a1);}
    tbody tr:nth-child(even){background:#f9fafb;}
    tbody tr:hover{background:#ecfdf5;}
    td.text-right{text-align:right; direction:rtl; unicode-bidi:plaintext; white-space:pre-wrap; word-break:break-word; overflow-wrap:anywhere;}

    .report-header{
      background:linear-gradient(135deg,#14532d,#166534);
      color:#fff;padding:14px 16px;border-radius:10px;
      margin-bottom:18px;text-align:center;
      box-shadow:0 4px 12px rgba(0,0,0,.08);
      border:1px solid rgba(255,255,255,.2);
    }
    .report-header h2{font-size:1.4rem;margin-bottom:10px;font-weight:800;text-shadow:1px 1px 2px rgba(0,0,0,.18);}
    .report-header .ministry{font-size:1.05rem;font-weight:700;margin-bottom:4px;}
    .report-header .program-title{font-size:1.25rem;font-weight:800;margin-top:8px;padding:8px 12px;background:rgba(255,255,255,.12);border-radius:8px;display:inline-block;}

    .toast{
      position:fixed;top:90px;left:50%;transform:translateX(-50%);
      background:linear-gradient(135deg,var(--primary),var(--secondary));
      color:#fff;padding:9px 14px;border-radius:999px;
      font-size:.85rem;font-weight:700;box-shadow:0 8px 20px rgba(15,118,110,.4);
      z-index:2000;animation:fadeIn .25s ease;max-width:90%;text-align:center;
    }
    .toast.warn{background:linear-gradient(135deg,#facc15,#eab308);color:#111827;}
    .toast.danger{background:linear-gradient(135deg,#ef4444,#b91c1c);}
    @keyframes fadeIn{from{opacity:0;transform:translate(-50%,-10px);}to{opacity:1;transform:translate(-50%,0);}}

    .site-footer{background:linear-gradient(135deg,var(--primary),var(--dark));color:#fff;padding:15px;text-align:center;box-shadow:0 -4px 20px rgba(0,0,0,.15);margin-top:30px;}
    .site-footer p{margin:5px 0;font-size:14px;}

    #back-btn{
      position:fixed;top:20px;right:20px;z-index:1000;
      background:var(--primary);color:white;border:none;
      padding:10px 15px;border-radius:5px;cursor:pointer;
      font-family:'Tajawal',sans-serif;box-shadow:0 2px 10px rgba(0,0,0,.2);
      display:none;
    }

    @media (max-width:768px){
      .cards-container{grid-template-columns:repeat(auto-fill,minmax(250px,1fr));}
      .header-text h1{font-size:1.5rem;}
      .card-page{padding:18px;}
      .report-header{padding:15px;}
      .report-header h2{font-size:1.3rem;}
    }
    @media (max-width:480px){
      .cards-container{grid-template-columns:1fr;}
      .header-text h1{font-size:1.3rem;}
      .report-header h2{font-size:1.15rem;}
    }
  </style>
</head>

<body>

<header class="header-logo">
  <div class="wrap">
    <img src="https://raw.githubusercontent.com/omymh/school26/main/26.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…" crossorigin="anonymous">
    <div class="header-text">
      <h1>Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</h1>
      <p>Ù…Ù†ØµØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©</p>
    </div>
    <div class="quran-verse">ï´¿ ÙˆÙÙ‚ÙÙ„Ù’ Ø±ÙØ¨ÙÙ‘ Ø²ÙØ¯Ù’Ù†ÙÙŠ Ø¹ÙÙ„Ù’Ù…Ù‹Ø§ ï´¾</div>
  </div>
</header>

<nav>
  <div class="nav-container">
    <div class="nav-title">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</div>
    <div class="cards-container">
      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/R1397/', 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±')">
        <div class="icon">ğŸ—“ï¸</div>
        <div class="title">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
        <div class="subtitle"><span>Ø§Ù„ÙŠÙˆÙ…ÙŠ</span><span>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</span><span>Ø§Ù„Ø´Ù‡Ø±ÙŠ</span></div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/A1397/', 'Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ')">
        <div class="icon">ğŸŒŸ</div>
        <div class="title">Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/AC1397/', 'Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù„Ø§ØµÙÙŠØ©')">
        <div class="icon">ğŸ§©</div>
        <div class="title">Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù„Ø§ØµÙÙŠØ©</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/Trace1397/', 'Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø£Ù†Ø´Ø·Ø©')">
        <div class="icon">ğŸ“‹</div>
        <div class="title">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø£Ù†Ø´Ø·Ø©</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/L1397/', 'Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±')">
        <div class="icon">ğŸ“</div>
        <div class="title">Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/T1397/', 'Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ')">
        <div class="icon">ğŸ“</div>
        <div class="title">Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/V1397/', 'ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª')">
        <div class="icon">ğŸ“</div>
        <div class="title">ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/P1397/', 'Ø®Ø±ÙŠØ·Ø© Ù†ÙˆØ§ØªØ¬ Ø§Ù„ØªØ¹Ù„Ù‘Ù…')">
        <div class="icon">ğŸ—ºï¸</div>
        <div class="title">Ø®Ø±ÙŠØ·Ø© Ù†ÙˆØ§ØªØ¬ Ø§Ù„ØªØ¹Ù„Ù‘Ù…</div>
      </div>

      <div class="card featured" onclick="window.loadLocal && window.loadLocal('wait')">
        <div class="icon">ğŸ•’</div>
        <div class="title">Ø­ØµØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
      </div>

      <div class="card labs" onclick="window.loadLocal && window.loadLocal('lab')">
        <div class="icon">ğŸ”¬</div>
        <div class="title">Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª</div>
      </div>

      <div class="card featured" onclick="window.loadLocal && window.loadLocal('general')">
        <div class="icon">ğŸ“„</div>
        <div class="title">ØªÙ‚Ø±ÙŠØ± Ø¹Ø§Ù…</div>
        <div class="subtitle"><span>ÙŠÙˆÙ…ÙŠ</span><span>Ø£Ø³Ø¨ÙˆØ¹ÙŠ</span><span>Ø´Ù‡Ø±ÙŠ</span></div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/PLC1397/', 'Ù…Ø¬ØªÙ…Ø¹Ø§Øª Ø§Ù„ØªØ¹Ù„Ù‘Ù… Ø§Ù„Ù…Ù‡Ù†ÙŠØ©')">
        <div class="icon">ğŸ“‘</div>
        <div class="title">Ù…Ø¬ØªÙ…Ø¹Ø§Øª Ø§Ù„ØªØ¹Ù„Ù‘Ù… Ø§Ù„Ù…Ù‡Ù†ÙŠØ©</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/D1397/', 'Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØµØ­Ù‘ÙŠ')">
        <div class="icon">âš•ï¸</div>
        <div class="title">Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØµØ­Ù‘ÙŠ</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/S1397/', 'Ø§Ù„ØªØ¹Ù„Ù‘Ù… Ø§Ù„Ù†Ø´Ø·')">
        <div class="icon">â™Ÿ</div>
        <div class="title">Ø§Ù„ØªØ¹Ù„Ù‘Ù… Ø§Ù„Ù†Ø´Ø·</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/LessonA1397/', 'Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠ')">
        <div class="icon">ğŸ“š</div>
        <div class="title">Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠ</div>
      </div>

      <div class="card" onclick="loadInIframe('https://defullah2010-svg.github.io/Warshah1397/', 'ÙˆØ±Ø´ Ø§Ù„Ø¹Ù…Ù„')">
        <div class="icon">ğŸ› ï¸</div>
        <div class="title">ÙˆØ±Ø´ Ø§Ù„Ø¹Ù…Ù„</div>
      </div>
    </div>
  </div>
</nav>

<main id="local-pages">

  <!-- Ø­ØµØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± -->
  <section id="wait-section" class="card-page" style="display:none;">
    <div class="report-header">
      <h2>ØªÙ‚Ø±ÙŠØ± ØªÙ†ÙÙŠØ°</h2>
      <div class="ministry">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
      <div class="program-title">Ø­ØµØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
    </div>

    <p class="wait-intro">Ø³Ø¬Ù„ÙŠ ØªÙØ§ØµÙŠÙ„ Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙŠ Ù‚Ù…ØªÙ Ø¨ØªÙ†ÙÙŠØ°Ù‡Ø§. ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­.</p>

    <form id="sesForm" class="form">
      <div class="grid-3">
        <label>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ *
          <select class="input" id="weekNumber" required>
            <option value="">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
            <option>Ø§Ù„Ø£ÙˆÙ„</option><option>Ø§Ù„Ø«Ø§Ù†ÙŠ</option><option>Ø§Ù„Ø«Ø§Ù„Ø«</option><option>Ø§Ù„Ø±Ø§Ø¨Ø¹</option><option>Ø§Ù„Ø®Ø§Ù…Ø³</option>
            <option>Ø§Ù„Ø³Ø§Ø¯Ø³</option><option>Ø§Ù„Ø³Ø§Ø¨Ø¹</option><option>Ø§Ù„Ø«Ø§Ù…Ù†</option><option>Ø§Ù„ØªØ§Ø³Ø¹</option><option>Ø§Ù„Ø¹Ø§Ø´Ø±</option>
            <option>Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±</option><option>Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±</option><option>Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ø´Ø±</option><option>Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø¹Ø´Ø±</option><option>Ø§Ù„Ø®Ø§Ù…Ø³ Ø¹Ø´Ø±</option>
          </select>
        </label>

        <label>Ø§Ù„ÙŠÙˆÙ… *
          <select class="input" id="dayName" required>
            <option value="">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„ÙŠÙˆÙ…</option>
            <option>Ø§Ù„Ø£Ø­Ø¯</option><option>Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</option><option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option><option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option><option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
          </select>
        </label>

        <label class="date-with-hijri">Ø§Ù„ØªØ§Ø±ÙŠØ® (Ù‡Ø¬Ø±ÙŠ) *
          <div class="date-input-container">
            <input class="input hijri-date-input" id="sessionDate" required placeholder="Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ" readonly>
            <button type="button" class="hijri-toggle">
              <svg class="hijri-icon" viewBox="0 0 24 24"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V9h14v10zM5 7V5h14v2H5zm2 4h10v2H7v-2zm0 4h7v2H7v-2z"/></svg>
            </button>
          </div>
          <div class="hijri-calendar">
            <div class="hijri-header">
              <div class="hijri-month-year"></div>
              <div class="hijri-nav">
                <button type="button" class="prev-year">Â«</button>
                <button type="button" class="prev-month">â€¹</button>
                <button type="button" class="next-month">â€º</button>
                <button type="button" class="next-year">Â»</button>
              </div>
            </div>
            <div class="hijri-weekdays">
              <span>Ø­</span><span>Ù†</span><span>Ø«</span><span>Ø±</span><span>Ø®</span><span>Ø¬</span><span>Ø³</span>
            </div>
            <div class="hijri-days"></div>
            <button type="button" class="today-btn">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…</button>
          </div>
        </label>
      </div>

      <div class="grid-3">
        <label>Ø§Ù„ØµÙ / Ø§Ù„ÙØµÙ„ *
          <input class="input" id="className" required placeholder="Ù…Ø«Ø§Ù„: 2 / Ø£">
        </label>
        <label>Ø±Ù‚Ù… Ø§Ù„Ø­ØµØ© *
          <input class="input" id="sessionNumber" required placeholder="Ù…Ø«Ø§Ù„: 3">
        </label>
        <label>Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø§Ù„ØºØ§Ø¦Ø¨Ø© *
          <input class="input" id="absentTeacher" required placeholder="Ù…Ø«Ø§Ù„: Ø£/ Ø³Ø§Ø±Ø© Ù…Ø­Ù…Ø¯">
        </label>
      </div>

      <label>Ù…Ø§ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡ Ù…Ø¹ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª *
        <textarea class="input" id="activitiesText" required placeholder="Ø§ÙƒØªØ¨ÙŠ Ø¨Ø¥ÙŠØ¬Ø§Ø² Ù…Ø§ ØªÙ… Ø¹Ù…Ù„Ù‡ ÙÙŠ Ø­ØµØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±..."></textarea>
      </label>

      <label>Ø§Ù„Ù…Ø¬Ø§Ù„ / Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø§Ø· *
        <div class="chipset">
          <label class="chip">
            <input type="checkbox" id="basicSkills">
            <span>Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</span>
          </label>
          <label class="chip">
            <input type="checkbox" id="values">
            <span>Ø§Ù„Ù‚ÙŠÙ… ÙˆØ§Ù„Ù…ÙˆØ§Ø·Ù†Ø© Ø§Ù„ØµØ§Ù„Ø­Ø©</span>
          </label>
          <label class="chip">
            <input type="checkbox" id="futureSkills">
            <span>Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</span>
          </label>
        </div>
      </label>

      <div class="actions">
        <button class="btn" type="button" id="saveSessionBtn">Ø­ÙØ¸ Ø§Ù„Ø­ØµØ©</button>
        <button class="btn" type="button" id="exportSessionsBtn">ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­ØµØµ PDF</button>
        <button class="btn danger" type="button" id="clearAllBtn">Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­ØµØµ</button>
      </div>
    </form>

    <h3 class="wait-subtitle">Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h3>
    <div class="table-wrap">
      <table>
        <thead>
        <tr>
          <th>Ù…</th><th>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th><th>Ø§Ù„ÙŠÙˆÙ…</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
          <th>Ø§Ù„ØµÙ</th><th>Ø§Ù„Ø­ØµØ©</th><th>Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø§Ù„ØºØ§Ø¦Ø¨Ø©</th>
          <th>Ù…Ø§ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡</th><th>Ø§Ù„Ù…Ø¬Ø§Ù„</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr>
        </thead>
        <tbody id="sessionsBody"></tbody>
      </table>
    </div>
  </section>

  <!-- Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª -->
  <section id="lab-section" class="card-page" style="display:none;">
    <div class="report-header">
      <h2>ØªÙ‚Ø±ÙŠØ± ØªÙ†ÙÙŠØ° Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
      <div class="ministry">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
      <div class="program-title">Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª</div>
    </div>

    <p class="lab-intro">Ø³Ø¬Ù„ÙŠ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ¬Ø§Ø±Ø¨ ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…Ù†ÙØ°Ø© ÙÙŠ Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª. ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­.</p>

    <form id="labForm" class="form lab-form">
      <div class="grid-3">
        <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ / Ø§Ù„ØªØ¬Ø±Ø¨Ø© *
          <input class="input" id="labProgram" required placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø£Ùˆ Ø§Ù„ØªØ¬Ø±Ø¨Ø©">
        </label>
        <label>Ø§Ù„Ù…Ù†ÙØ°Ø© *
          <input class="input" id="labExecutor" required placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ÙØ°Ø©">
        </label>
        <label>Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ° *
          <input class="input" id="labLocation" required placeholder="Ù…ÙƒØ§Ù† ØªÙ†ÙÙŠØ° Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬">
        </label>
      </div>

      <div class="grid-3">
        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙŠÙ† *
          <input class="input" id="labTargetCount" type="number" min="1" required placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙŠÙ†">
        </label>

        <label class="date-with-hijri">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ° (Ù‡Ø¬Ø±ÙŠ) *
          <div class="date-input-container">
            <input class="input hijri-date-input" id="labDate" required placeholder="Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ" readonly>
            <button type="button" class="hijri-toggle">
              <svg class="hijri-icon" viewBox="0 0 24 24"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V9h14v10zM5 7V5h14v2H5zm2 4h10v2H7v-2zm0 4h7v2H7v-2z"/></svg>
            </button>
          </div>
          <div class="hijri-calendar">
            <div class="hijri-header">
              <div class="hijri-month-year"></div>
              <div class="hijri-nav">
                <button type="button" class="prev-year">Â«</button>
                <button type="button" class="prev-month">â€¹</button>
                <button type="button" class="next-month">â€º</button>
                <button type="button" class="next-year">Â»</button>
              </div>
            </div>
            <div class="hijri-weekdays">
              <span>Ø­</span><span>Ù†</span><span>Ø«</span><span>Ø±</span><span>Ø®</span><span>Ø¬</span><span>Ø³</span>
            </div>
            <div class="hijri-days"></div>
            <button type="button" class="today-btn">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…</button>
          </div>
        </label>
        <div></div>
      </div>

      <label>Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙˆÙ† *
        <textarea class="input" id="labBeneficiaries" required placeholder="Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙÙŠØ¯Ø© (Ù…Ø«Ø§Ù„: Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹ØŒ Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ø¹Ù„ÙˆÙ…...)"></textarea>
      </label>

      <label>Ø§Ù„Ø£Ù‡Ø¯Ø§Ù *
        <textarea class="input" id="labGoals" required placeholder="Ø§ÙƒØªØ¨ÙŠ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø£Ùˆ Ø§Ù„ØªØ¬Ø±Ø¨Ø©..."></textarea>
      </label>

      <label>Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ (ØµÙˆØ±) * (Ø­Ø¯ Ø£Ù‚ØµÙ‰ 4 ØµÙˆØ±)
        <input class="input" id="labEvidence" type="file" accept="image/*" multiple required>
        <small style="font-weight:400;color:#6b7280;margin-top:2px;">
          ØªÙ†Ø¨ÙŠÙ‡: Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¹Ù„Ù‰ 4 ØµÙˆØ± ÙÙ‚Ø·. (ÙˆØ£Ù†Ø§ Ø¶ØºØ·ØªÙ‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸ Ø­ØªÙ‰ Ù…Ø§ ÙŠÙ†ÙØ¬Ø± Ø§Ù„ØªØ®Ø²ÙŠÙ† ÙÙŠ Ø§Ù„Ø¬ÙˆØ§Ù„)
        </small>
      </label>

      <div class="actions">
        <button class="btn" type="button" id="saveLabBtn">Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
        <button class="btn" type="button" id="exportLabsBtn">ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± PDF</button>
        <button class="btn danger" type="button" id="clearLabsBtn">Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
      </div>
    </form>

    <h3 class="lab-subtitle">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h3>
    <div class="table-wrap">
      <table class="lab-table">
        <thead>
        <tr>
          <th>Ù…</th>
          <th>Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ / Ø§Ù„ØªØ¬Ø±Ø¨Ø©</th>
          <th>Ø§Ù„Ù…Ù†ÙØ°Ø©</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°</th>
          <th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙŠÙ†</th>
          <th>Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙˆÙ†</th>
          <th>Ø§Ù„Ø£Ù‡Ø¯Ø§Ù</th>
          <th>Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ (ØµÙˆØ±)</th>
          <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr>
        </thead>
        <tbody id="labsBody"></tbody>
      </table>
    </div>
  </section>

  <!-- Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ø§Ù… -->
  <section id="general-section" class="card-page" style="display:none;">
    <div class="report-header" style="background:linear-gradient(135deg,#0f766e,#0e7490);">
      <h2>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ø§Ù…</h2>
      <div class="ministry">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
      <div class="program-title">ØªÙ‚Ø±ÙŠØ± ØªÙ†ÙÙŠØ° Ø¨Ø±Ù†Ø§Ù…Ø¬ / ÙØ¹Ø§Ù„ÙŠØ©</div>
    </div>

    <p class="general-intro">Ø§Ø³ØªØ®Ø¯Ù…ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù„ØªÙˆØ«ÙŠÙ‚ Ø£ÙŠ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø£Ùˆ ÙØ¹Ø§Ù„ÙŠØ© (Ø¹Ø§Ù… / ÙŠÙˆÙ…ÙŠ / Ø£Ø³Ø¨ÙˆØ¹ÙŠ / Ø´Ù‡Ø±ÙŠ).</p>

    <form id="generalForm" class="form">
      <div class="grid-3">
        <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ / Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© *
          <input class="input" id="gProgram" required placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ / Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©">
        </label>
        <label>Ø§Ù„Ù…Ù†ÙØ°Ø© *
          <input class="input" id="gExecutor" required placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ÙØ°Ø©">
        </label>
        <label>Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ° *
          <input class="input" id="gLocation" required placeholder="Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ° (Ù…Ø«Ø§Ù„: Ù…Ø³Ø±Ø­ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©)">
        </label>
      </div>

      <div class="grid-3">
        <label>Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± *
          <select class="input" id="gType" required>
            <option value="">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù†ÙˆØ¹</option>
            <option>ÙŠÙˆÙ…ÙŠ</option>
            <option>Ø£Ø³Ø¨ÙˆØ¹ÙŠ</option>
            <option>Ø´Ù‡Ø±ÙŠ</option>
            <option>ÙØµÙ„ÙŠ</option>
            <option>Ø¹Ø§Ù…</option>
          </select>
        </label>

        <label class="date-with-hijri">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ° (Ù‡Ø¬Ø±ÙŠ) *
          <div class="date-input-container">
            <input class="input hijri-date-input" id="gDate" required placeholder="Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ" readonly>
            <button type="button" class="hijri-toggle">
              <svg class="hijri-icon" viewBox="0 0 24 24"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V9h14v10zM5 7V5h14v2H5zm2 4h10v2H7v-2zm0 4h7v2H7v-2z"/></svg>
            </button>
          </div>
          <div class="hijri-calendar">
            <div class="hijri-header">
              <div class="hijri-month-year"></div>
              <div class="hijri-nav">
                <button type="button" class="prev-year">Â«</button>
                <button type="button" class="prev-month">â€¹</button>
                <button type="button" class="next-month">â€º</button>
                <button type="button" class="next-year">Â»</button>
              </div>
            </div>
            <div class="hijri-weekdays">
              <span>Ø­</span><span>Ù†</span><span>Ø«</span><span>Ø±</span><span>Ø®</span><span>Ø¬</span><span>Ø³</span>
            </div>
            <div class="hijri-days"></div>
            <button type="button" class="today-btn">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…</button>
          </div>
        </label>

        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ† *
          <input class="input" id="gCount" type="number" min="1" required placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ†">
        </label>
      </div>

      <label>Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙˆÙ† *
        <textarea class="input" id="gBeneficiaries" required placeholder="Ø§ÙƒØªØ¨ÙŠ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙÙŠØ¯Ø© (Ù…Ø«Ø§Ù„: Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø¹Ù„ÙŠØ§ØŒ Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø©...)"></textarea>
      </label>

      <label>Ø£Ø¨Ø±Ø² Ù…Ø§ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡ *
        <textarea class="input" id="gDetails" required placeholder="Ø³Ø¬Ù„ÙŠ Ø¨Ø¥ÙŠØ¬Ø§Ø² Ø£Ù‡Ù… Ù…Ø§ ØªÙ… ÙÙŠ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ / Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©..."></textarea>
      </label>

      <div class="actions">
        <button class="btn" type="button" id="saveGeneralBtn">Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
        <button class="btn" type="button" id="exportGeneralBtn">ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± PDF</button>
        <button class="btn danger" type="button" id="clearGeneralBtn">Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
      </div>
    </form>

    <h3 class="general-subtitle">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h3>
    <div class="table-wrap">
      <table class="general-table">
        <thead>
        <tr>
          <th>Ù…</th><th>Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</th><th>Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ†</th>
          <th>Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙˆÙ†</th><th>Ø£Ø¨Ø±Ø² Ù…Ø§ ØªÙ…</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr>
        </thead>
        <tbody id="generalBody"></tbody>
      </table>
    </div>
  </section>

</main>

<div id="iframe-container">
  <iframe id="content-frame" src="about:blank"></iframe>
</div>

<footer class="site-footer">
  <p>Ù†Ø¸Ø§Ù… Ø¯Ø§Ø®Ù„ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</p>
</footer>

<button id="back-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
  // ============================================================================
  // Helpers
  // ============================================================================

  function isIOS(){
    return /iPad|iPhone|iPod/.test(navigator.userAgent) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
  }

  window.showToast = function(msg,type){
    type = type || '';
    const t=document.createElement('div');
    t.className='toast'+(type?' '+type:'');
    t.textContent=msg;
    document.body.appendChild(t);
    setTimeout(()=>{t.style.opacity='0';t.style.transition='opacity .25s';},1400);
    setTimeout(()=>{t.remove();},1900);
  };

  function getJsPDF(){
    if(window.jspdf && window.jspdf.jsPDF) return window.jspdf.jsPDF;
    if(window.jsPDF) return window.jsPDF;
    throw new Error('jsPDF library not loaded');
  }

  window.escapeHtml = function(text){
    if(text === null || text === undefined) return '';
    return String(text)
      .replace(/&/g, '&amp;')
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;')
      .replace(/"/g, '&quot;')
      .replace(/'/g, '&#039;');
  };

  // âœ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¹Ø±Ø¶ ØµØ­ÙŠØ­ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ + PDF
  window.nl2brSafe = function(text){
    return window.escapeHtml(text || '').replace(/\n/g, '<br>');
  };

  // âœ… html2canvas Ø¹Ù„Ù‰ iPhone Ù…Ù…ÙƒÙ† ÙŠØ¹Ø·ÙŠ Ø´Ø§Ø´Ø© Ø³ÙˆØ¯Ø§Ø¡ Ø¥Ø°Ø§ Ø§Ù„Ø¹Ù†ØµØ± fixed/ÙƒØ¨ÙŠØ±/scale Ø¹Ø§Ù„ÙŠ
  function captureAsCanvas(el){
    const scale = isIOS() ? 1 : 1.5;
    return html2canvas(el,{
      scale,
      backgroundColor:'#ffffff',
      useCORS:true,
      logging:false,
      removeContainer:true
    });
  }

  // Ø¶ØºØ· ØµÙˆØ±Ø© Ù„ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† (Ù…Ù‡Ù… Ù„Ù„Ø¬ÙˆØ§Ù„ + localStorage)
  function compressImageToDataURL(file, maxW=1280, quality=0.82){
    return new Promise((resolve,reject)=>{
      const reader=new FileReader();
      reader.onerror = reject;
      reader.onload = () => {
        const img = new Image();
        img.onerror = reject;
        img.onload = () => {
          let w = img.width;
          let h = img.height;
          if(w > maxW){
            const r = maxW / w;
            w = Math.round(w * r);
            h = Math.round(h * r);
          }
          const canvas = document.createElement('canvas');
          canvas.width = w;
          canvas.height = h;
          const ctx = canvas.getContext('2d');
          ctx.fillStyle = '#fff';
          ctx.fillRect(0,0,w,h);
          ctx.drawImage(img,0,0,w,h);
          try{
            const dataUrl = canvas.toDataURL('image/jpeg', quality);
            resolve(dataUrl);
          }catch(e){
            reject(e);
          }
        };
        img.src = reader.result;
      };
      reader.readAsDataURL(file);
    });
  }

  // ============================================================================
  // Navigation
  // ============================================================================

  window.loadInIframe = function(url,title){
    const iframeContainer=document.getElementById('iframe-container');
    const iframe=document.getElementById('content-frame');
    const nav=document.querySelector('nav');
    const localPages=document.getElementById('local-pages');
    const backBtn=document.getElementById('back-btn');

    document.title=(title||'ØªÙ‚Ø±ÙŠØ±')+' - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©';

    localPages.style.display='none';
    document.getElementById('wait-section').style.display='none';
    document.getElementById('lab-section').style.display='none';
    document.getElementById('general-section').style.display='none';

    iframe.src=url;
    iframeContainer.style.display='block';
    iframeContainer.scrollIntoView({behavior:'smooth'});
    nav.style.display='block';
    backBtn.style.display='block';

    backBtn.onclick=function(){
      iframeContainer.style.display='none';
      iframe.src='about:blank';
      nav.style.display='block';
      document.title='Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©';
      backBtn.style.display='none';
      window.scrollTo({top:0,behavior:'smooth'});
    };
  };

  window.loadLocal = function(which){
    const iframeContainer=document.getElementById('iframe-container');
    const nav=document.querySelector('nav');
    const localPages=document.getElementById('local-pages');
    const backBtn=document.getElementById('back-btn');

    iframeContainer.style.display='none';
    document.getElementById('content-frame').src='about:blank';

    localPages.style.display='block';
    document.getElementById('wait-section').style.display= which==='wait' ? 'block' : 'none';
    document.getElementById('lab-section').style.display = which==='lab' ? 'block' : 'none';
    document.getElementById('general-section').style.display = which==='general' ? 'block' : 'none';

    document.title=(which==='wait'?'Ø­ØµØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±':which==='lab'?'Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª':'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ø§Ù…')+' - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©';
    nav.style.display='block';
    backBtn.style.display='block';
    localPages.scrollIntoView({behavior:'smooth'});

    backBtn.onclick=function(){
      localPages.style.display='none';
      document.getElementById('wait-section').style.display='none';
      document.getElementById('lab-section').style.display='none';
      document.getElementById('general-section').style.display='none';
      document.title='Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©';
      backBtn.style.display='none';
      window.scrollTo({top:0,behavior:'smooth'});
    };
  };

  // ============================================================================
  // Waiting sessions (Ø­ØµØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±)
  // ============================================================================

  let waitSessions=[];
  const WAIT_KEY = 'w26_waiting_sessions';

  function waitLoad(){
    try{
      const saved=localStorage.getItem(WAIT_KEY);
      waitSessions = saved ? (JSON.parse(saved)||[]) : [];
    }catch(e){
      waitSessions=[];
    }
    renderWait();
  }

  function waitPersist(){
    localStorage.setItem(WAIT_KEY, JSON.stringify(waitSessions));
  }

  function renderWait(){
    const body=document.getElementById('sessionsBody');
    if(!body) return;
    body.innerHTML='';
    waitSessions.forEach((s,i)=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`<td>${i+1}</td>
        <td>${window.escapeHtml(s.week)}</td>
        <td>${window.escapeHtml(s.day)}</td>
        <td>${window.escapeHtml(s.date)}</td>
        <td>${window.escapeHtml(s.className)}</td>
        <td>${window.escapeHtml(s.number)}</td>
        <td>${window.escapeHtml(s.teacher)}</td>
        <td class="text-right">${window.nl2brSafe(s.activities)}</td>
        <td class="text-right">${window.escapeHtml(s.fields)}</td>
        <td><button class="btn danger" style="width:auto;padding:4px 8px;font-size:.75rem;border-radius:999px;box-shadow:none;" onclick="deleteWait(${i})">Ø­Ø°Ù</button></td>`;
      body.appendChild(tr);
    });
  }

  window.deleteWait = function(i){
    if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ÙŠÙ† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø­ØµØ©ØŸ')) return;
    waitSessions.splice(i,1);
    waitPersist();
    renderWait();
    window.showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­ØµØ©');
  };

  function initWaitForm(){
    document.getElementById('saveSessionBtn').addEventListener('click', ()=>{
      const week=document.getElementById('weekNumber').value;
      const day=document.getElementById('dayName').value;
      const date=document.getElementById('sessionDate').value;
      const className=document.getElementById('className').value.trim();
      const number=document.getElementById('sessionNumber').value.trim();
      const teacher=document.getElementById('absentTeacher').value.trim();
      const activities=document.getElementById('activitiesText').value.trim();

      const fields=[];
      if(document.getElementById('basicSkills').checked) fields.push('Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©');
      if(document.getElementById('values').checked) fields.push('Ø§Ù„Ù‚ÙŠÙ… ÙˆØ§Ù„Ù…ÙˆØ§Ø·Ù†Ø© Ø§Ù„ØµØ§Ù„Ø­Ø©');
      if(document.getElementById('futureSkills').checked) fields.push('Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„');

      if(!week||!day||!date||!className||!number||!teacher||!activities||fields.length===0){
        window.showToast('Ø£ÙƒÙ…Ù„ÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ø®ØªØ± Ù…Ø¬Ø§Ù„Ø§Ù‹ ÙˆØ§Ø­Ø¯Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„','warn');
        return;
      }

      waitSessions.push({week,day,date,className,number,teacher,activities,fields:fields.join('ØŒ ')});
      waitPersist();
      renderWait();
      document.getElementById('sesForm').reset();
      window.showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø­ØµØ©');
    });

    document.getElementById('clearAllBtn').addEventListener('click', ()=>{
      if(!waitSessions.length){window.showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­ØµØµ Ù…Ø³Ø¬Ù„Ø©','warn');return;}
      if(!confirm('Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±ØŸ')) return;
      waitSessions=[];
      waitPersist();
      renderWait();
      window.showToast('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­ØµØµ');
    });

    document.getElementById('exportSessionsBtn').addEventListener('click', async ()=>{
      if(!waitSessions.length){window.showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­ØµØµ Ù…Ø³Ø¬Ù„Ø©','warn');return;}
      window.showToast('Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ù…Ù„Ù PDF...','warn');

      // âœ… Ù…Ù‡Ù…: Ù„Ø§ Ù†Ø³ØªØ®Ø¯Ù… position:fixed (ÙŠØ³Ø¨Ø¨ Ø´Ø§Ø´Ø© Ø³ÙˆØ¯Ø§Ø¡ Ø¹Ù„Ù‰ iPhone)
      const printDiv=document.createElement('div');
      printDiv.style.cssText="position:absolute;left:-10000px;top:0;width:1123px;background:#fff;padding:30px;direction:rtl;font-family:'Tajawal',sans-serif;font-size:14px;";

      let rows='';
      waitSessions.forEach((s,i)=>{
        rows+=`<tr>
          <td style="border:1px solid #bbf7d0;padding:6px;">${i+1}</td>
          <td style="border:1px solid #bbf7d0;padding:6px;">${window.escapeHtml(s.week||'')}</td>
          <td style="border:1px solid #bbf7d0;padding:6px;">${window.escapeHtml(s.day)}</td>
          <td style="border:1px solid #bbf7d0;padding:6px;">${window.escapeHtml(s.date)}</td>
          <td style="border:1px solid #bbf7d0;padding:6px;">${window.escapeHtml(s.className)}</td>
          <td style="border:1px solid #bbf7d0;padding:6px;">${window.escapeHtml(s.number)}</td>
          <td style="border:1px solid #bbf7d0;padding:6px;">${window.escapeHtml(s.teacher)}</td>
          <td style="border:1px solid #bbf7d0;padding:6px;text-align:right;direction:rtl;unicode-bidi:plaintext;white-space:pre-wrap;">${window.nl2brSafe(s.activities)}</td>
          <td style="border:1px solid #bbf7d0;padding:6px;text-align:right;direction:rtl;unicode-bidi:plaintext;white-space:pre-wrap;">${window.escapeHtml(s.fields)}</td>
        </tr>`;
      });

      printDiv.innerHTML=`
        <div style="text-align:center;margin-bottom:14px;">
          <img src="https://raw.githubusercontent.com/omymh/school26/main/26.png" crossorigin="anonymous"
               style="width:100%;height:60px;object-fit:contain;margin-bottom:6px;">
          <h1 style="color:#047857;font-size:20px;margin:0 0 6px;font-weight:900;border-bottom:1px solid #bbf7d0;padding-bottom:6px;">
            ØªÙ‚Ø§Ø±ÙŠØ± Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
          </h1>
        </div>
        <table style="width:100%;border-collapse:collapse;font-size:13px;">
          <thead>
            <tr>
              <th style="border:1px solid #bbf7d0;background:#16a34a;color:#fff;padding:6px;">Ù…</th>
              <th style="border:1px solid #bbf7d0;background:#16a34a;color:#fff;padding:6px;">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th>
              <th style="border:1px solid #bbf7d0;background:#16a34a;color:#fff;padding:6px;">Ø§Ù„ÙŠÙˆÙ…</th>
              <th style="border:1px solid #bbf7d0;background:#16a34a;color:#fff;padding:6px;">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
              <th style="border:1px solid #bbf7d0;background:#16a34a;color:#fff;padding:6px;">Ø§Ù„ØµÙ</th>
              <th style="border:1px solid #bbf7d0;background:#16a34a;color:#fff;padding:6px;">Ø§Ù„Ø­ØµØ©</th>
              <th style="border:1px solid #bbf7d0;background:#16a34a;color:#fff;padding:6px;">Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø§Ù„ØºØ§Ø¦Ø¨Ø©</th>
              <th style="border:1px solid #bbf7d0;background:#16a34a;color:#fff;padding:6px;">Ù…Ø§ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡</th>
              <th style="border:1px solid #bbf7d0;background:#16a34a;color:#fff;padding:6px;">Ø§Ù„Ù…Ø¬Ø§Ù„</th>
            </tr>
          </thead>
          <tbody>${rows}</tbody>
        </table>

        <div style="margin-top:20px;padding-top:6px;border-top:1px solid #bbf7d0;text-align:left;direction:ltr;">
          <p style="margin:0 0 3px;font-weight:bold;color:#047857;font-size:14px;">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</p>
          <p style="margin:0;font-size:14px;color:#047857;">Ø£Ù…Ø§Ù†ÙŠ Ø¢Ù„ Ø¹Ø¨Ø´Ø§Ù†</p>
        </div>
      `;

      document.body.appendChild(printDiv);
      const canvas=await captureAsCanvas(printDiv);
      printDiv.remove();

      const imgData=canvas.toDataURL('image/jpeg',0.92);

      const JsPDF=getJsPDF();
      const pdf=new JsPDF({orientation:'landscape',unit:'mm',format:'a4'});
      const pageWidth=pdf.internal.pageSize.getWidth();
      const pageHeight=pdf.internal.pageSize.getHeight();

      const imgWidth=pageWidth;
      const imgHeight=(canvas.height*imgWidth)/canvas.width;

      let heightLeft=imgHeight;
      let position=0;

      pdf.addImage(imgData,'JPEG',0,position,imgWidth,imgHeight);
      heightLeft -= pageHeight;

      while(heightLeft > 0){
        position = heightLeft - imgHeight;
        pdf.addPage();
        pdf.addImage(imgData,'JPEG',0,position,imgWidth,imgHeight);
        heightLeft -= pageHeight;
      }

      pdf.save('ØªÙ‚Ø§Ø±ÙŠØ± Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±.pdf');
      window.showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ù…Ù„Ù PDF');
    });
  }

  // ============================================================================
  // Labs (Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª) â€” âœ… Ø­Ù„ Ø²Ø± Ø§Ù„Ø­ÙØ¸ + Ø­Ø¯ Ø§Ù„ØµÙˆØ± 4 + Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù + Ø­Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
  // ============================================================================

  let labExperiments=[];
  const LAB_KEY = 'w26_lab_experiments';

  function labLoad(){
    try{
      const saved=localStorage.getItem(LAB_KEY);
      labExperiments = saved ? (JSON.parse(saved)||[]) : [];
    }catch(e){
      labExperiments=[];
    }
    labRender();
  }

  // âœ… Ù…Ù‡Ù…: Ù„Ø§ Ù†Ø³Ù…ÙŠÙ‡Ø§ saveLab Ù„Ø£Ù† ID Ø§Ù„Ø²Ø±/Ø§Ù„Ø¹Ù†ØµØ± ÙƒØ§Ù† ÙŠÙƒØ³Ù‘Ø± Ø§Ù„Ø¯Ø§Ù„Ø© Ø¹Ù„Ù‰ iPhone
  function labPersist(){
    try{
      localStorage.setItem(LAB_KEY, JSON.stringify(labExperiments));
    }catch(e){
      window.showToast('Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù…ØªÙ„Ø£. Ù‚Ù„Ù„ÙŠ Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ± Ø£Ùˆ Ø§Ø­Ø°ÙÙŠ ØªÙ‚Ø§Ø±ÙŠØ± Ù‚Ø¯ÙŠÙ…Ø©','danger');
      throw e;
    }
  }

  function labRender(){
    const body=document.getElementById('labsBody');
    if(!body) return;

    body.innerHTML='';
    labExperiments.forEach((e,i)=>{
      const evidenceText = (e.evidenceImages && e.evidenceImages.length)
        ? (e.evidenceImages.length + ' ØµÙˆØ±Ø©')
        : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';

      const tr=document.createElement('tr');
      tr.innerHTML=`<td>${i+1}</td>
        <td class="text-right">${window.escapeHtml(e.program)}</td>
        <td>${window.escapeHtml(e.executor)}</td>
        <td>${window.escapeHtml(e.date)}</td>
        <td>${window.escapeHtml(e.targetCount)}</td>
        <td class="text-right">${window.nl2brSafe(e.beneficiaries)}</td>
        <td class="text-right">${window.nl2brSafe(e.goals)}</td>
        <td class="text-right">${window.escapeHtml(evidenceText)}</td>
        <td>
          <button class="btn danger"
                  style="width:auto;padding:4px 8px;font-size:.75rem;border-radius:999px;box-shadow:none;"
                  onclick="deleteLab(${i})">
            Ø­Ø°Ù
          </button>
        </td>`;
      body.appendChild(tr);
    });
  }

  window.deleteLab = function(i){
    if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ÙŠÙ† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ±ØŸ')) return;
    labExperiments.splice(i,1);
    labPersist();
    labRender();
    window.showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„ØªÙ‚Ø±ÙŠØ±');
  };

  function initLabForm(){
    const evidenceInput = document.getElementById('labEvidence');
    const saveBtn = document.getElementById('saveLabBtn');

    // âœ… Ø­Ø¯ 4 ØµÙˆØ± ÙÙ‚Ø·
    evidenceInput.addEventListener('change', ()=>{
      if(evidenceInput.files && evidenceInput.files.length > 4){
        window.showToast('Ù…Ø³Ù…ÙˆØ­ 4 ØµÙˆØ± ÙÙ‚Ø·. Ø§Ø®ØªØ§Ø±ÙŠ 4 Ø£Ùˆ Ø£Ù‚Ù„.','warn');
        evidenceInput.value = '';
      }
    });

    saveBtn.addEventListener('click', async ()=>{
      const program=document.getElementById('labProgram').value.trim();
      const executor=document.getElementById('labExecutor').value.trim();
      const location=document.getElementById('labLocation').value.trim();
      const targetCount=document.getElementById('labTargetCount').value.trim();
      const date=document.getElementById('labDate').value.trim();
      const beneficiaries=document.getElementById('labBeneficiaries').value.trim();
      const goals=document.getElementById('labGoals').value.trim();

      const files = evidenceInput.files ? Array.from(evidenceInput.files) : [];

      if(!program||!executor||!location||!targetCount||!date||!beneficiaries||!goals||files.length===0){
        window.showToast('Ø£ÙƒÙ…Ù„ÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ ØµÙˆØ± Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯','warn');
        return;
      }
      if(files.length > 4){
        window.showToast('Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¹Ù„Ù‰ 4 ØµÙˆØ± ÙÙ‚Ø·','warn');
        return;
      }

      // Ù…Ù†Ø¹ Ø¶ØºØ·Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©
      saveBtn.disabled = true;
      const oldText = saveBtn.textContent;
      saveBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...';

      try{
        // âœ… Ø¶ØºØ· Ø§Ù„ØµÙˆØ± Ù‚Ø¨Ù„ Ø§Ù„ØªØ®Ø²ÙŠÙ†
        const evidenceImages = [];
        for(const f of files){
          const dataUrl = await compressImageToDataURL(f, 1280, 0.82);
          evidenceImages.push(dataUrl);
        }

        // Ø­ÙØ¸
        labExperiments.push({
          program,
          executor,
          location,
          targetCount,
          date,
          beneficiaries,
          goals,
          evidenceImages
        });

        labPersist();
        labRender();

        document.getElementById('labForm').reset();
        window.showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±');

      }catch(e){
        window.showToast('ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±. ØºØ§Ù„Ø¨Ø§Ù‹ Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ± ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹.','danger');
        console.error(e);
      }finally{
        saveBtn.disabled = false;
        saveBtn.textContent = oldText;
      }
    });

    document.getElementById('clearLabsBtn').addEventListener('click', ()=>{
      if(!labExperiments.length){
        window.showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø³Ø¬Ù„Ø©','warn');
        return;
      }
      if(!confirm('Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§ØªØŸ')) return;
      labExperiments=[];
      localStorage.removeItem(LAB_KEY);
      labRender();
      window.showToast('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±');
    });

    document.getElementById('exportLabsBtn').addEventListener('click', async ()=>{
      if(!labExperiments.length){
        window.showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø³Ø¬Ù„Ø©','warn');
        return;
      }
      window.showToast('Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ù…Ù„Ù PDF...','warn');

      const JsPDF=getJsPDF();
      const pdf=new JsPDF({orientation:'portrait',unit:'mm',format:'a4'});
      const pageWidth=pdf.internal.pageSize.getWidth();

      for(let i=0;i<labExperiments.length;i++){
        const exp=labExperiments[i];

        // âœ… Ù„Ø§ fixed (Ù„ØªÙØ§Ø¯ÙŠ Ø´Ø§Ø´Ø© Ø³ÙˆØ¯Ø§Ø¡ Ø¹Ù„Ù‰ iPhone)
        const printDiv=document.createElement('div');
        printDiv.style.cssText="position:absolute;left:-10000px;top:0;width:794px;background:#fff;padding:40px 40px 30px;direction:rtl;font-family:'Tajawal',sans-serif;font-size:15px;";

        // ØµÙˆØ± â€” Ø¨Ø§Ù„ÙØ¹Ù„ Ù…Ø­Ø¯ÙˆØ¯ÙŠÙ† 4
        const imagesHtml = (exp.evidenceImages && exp.evidenceImages.length)
          ? exp.evidenceImages.slice(0,4).map(src=>`
              <div style="width:120px;height:90px;border:1px solid #bbf7d0;border-radius:8px;overflow:hidden;background:#fff;">
                <img src="${src}" style="width:100%;height:100%;object-fit:cover;display:block;">
              </div>
            `).join('')
          : '<span style="font-size:14px;font-weight:500;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù…Ø±ÙÙ‚Ø©</span>';

        printDiv.innerHTML=`
          <div style="text-align:center;margin-bottom:18px;">
            <img src="https://raw.githubusercontent.com/omymh/school26/main/26.png"
                 crossorigin="anonymous"
                 style="width:100%;height:70px;object-fit:contain;margin-bottom:8px;">
            <div style="font-weight:800;font-size:17px;margin-top:4px;">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
            <div style="font-weight:900;font-size:18px;margin-top:4px;">ØªÙ‚Ø±ÙŠØ± ØªÙ†ÙÙŠØ° Ø¨Ø±Ù†Ø§Ù…Ø¬ â€“ Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª</div>
            <div style="margin-top:10px;font-size:15px;font-weight:800;">
              Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ / Ø§Ù„ØªØ¬Ø±Ø¨Ø©:
              <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(exp.program || '')}</span>
            </div>
          </div>

          <!-- âœ… Ø­Ø¯/Ø®Ø· ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· -->
          <div style="border:1px solid #bbf7d0;border-radius:12px;padding:18px 14px;line-height:2;">
            <div style="font-size:15px;font-weight:800;margin-bottom:4px;">
              Ø§Ù„Ù…Ù†ÙØ°Ø©:
              <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(exp.executor || '')}</span>
            </div>

            <div style="font-size:15px;font-weight:800;margin-bottom:4px;">
              Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°:
              <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(exp.location || '')}</span>
            </div>

            <div style="font-size:15px;font-weight:800;margin-bottom:4px;">
              Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙŠÙ†:
              <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(exp.targetCount || '')}</span>
            </div>

            <!-- âœ… ØµÙ†Ø¯ÙˆÙ‚ Ù†Øµ Ù„Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ† -->
            <div style="font-size:15px;font-weight:900;margin:12px 0 6px;">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙˆÙ†:</div>
            <div style="border:1px solid #bbf7d0;border-radius:10px;padding:10px 12px;background:#f8fffb;
                        font-size:15px;font-weight:500;line-height:1.9;text-align:right;direction:rtl;unicode-bidi:plaintext;white-space:pre-wrap;">
              ${window.nl2brSafe(exp.beneficiaries || '')}
            </div>

            <!-- âœ… ØµÙ†Ø¯ÙˆÙ‚ Ù†Øµ Ù„Ù„Ø£Ù‡Ø¯Ø§Ù (Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù„Ø®Ø¨Ø·Ø©) -->
            <div style="font-size:15px;font-weight:900;margin:12px 0 6px;">Ø§Ù„Ø£Ù‡Ø¯Ø§Ù:</div>
            <div style="border:1px solid #bbf7d0;border-radius:10px;padding:10px 12px;background:#f8fffb;
                        font-size:15px;font-weight:500;line-height:1.9;text-align:right;direction:rtl;unicode-bidi:plaintext;white-space:pre-wrap;">
              ${window.nl2brSafe(exp.goals || '')}
            </div>

            <div style="font-size:15px;font-weight:900;margin:12px 0 6px;">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ (ØµÙˆØ±):</div>
            <div style="display:flex;flex-wrap:wrap;gap:8px;">
              ${imagesHtml}
            </div>

            <div style="font-size:15px;font-weight:900;margin-top:12px;">
              ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°:
              <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(exp.date || '')} Ù‡Ù€</span>
            </div>
          </div>

          <div style="margin-top:22px;padding-top:10px;border-top:1px solid #bbf7d0;">
            <div style="display:flex;justify-content:flex-start;direction:ltr;">
              <div style="text-align:left;">
                <p style="margin:0 0 3px;font-weight:bold;color:#047857;font-size:14px;">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</p>
                <p style="margin:0;font-size:14px;color:#047857;">Ø£Ù…Ø§Ù†ÙŠ Ø¢Ù„ Ø¹Ø¨Ø´Ø§Ù†</p>
              </div>
            </div>
          </div>
        `;

        document.body.appendChild(printDiv);
        const canvas=await captureAsCanvas(printDiv);
        printDiv.remove();

        const imgData=canvas.toDataURL('image/jpeg',0.92);
        const imgWidth=pageWidth;
        const imgHeight=(canvas.height*imgWidth)/canvas.width;

        if(i>0) pdf.addPage();
        pdf.addImage(imgData,'JPEG',0,0,imgWidth,imgHeight);
      }

      pdf.save('ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª.pdf');
      window.showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ù…Ù„Ù PDF');
    });
  }

  // ============================================================================
  // General (Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ø§Ù…)
  // ============================================================================

  let generalReports=[];
  const GEN_KEY = 'w26_general_reports';

  function generalLoad(){
    try{
      const saved=localStorage.getItem(GEN_KEY);
      generalReports = saved ? (JSON.parse(saved)||[]) : [];
    }catch(e){
      generalReports=[];
    }
    renderGeneral();
  }

  function generalPersist(){
    try{
      localStorage.setItem(GEN_KEY, JSON.stringify(generalReports));
    }catch(e){
      window.showToast('Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù…ØªÙ„Ø£. Ø§Ø­Ø°ÙÙŠ ØªÙ‚Ø§Ø±ÙŠØ± Ù‚Ø¯ÙŠÙ…Ø©','danger');
      throw e;
    }
  }

  function renderGeneral(){
    const body=document.getElementById('generalBody');
    if(!body) return;

    body.innerHTML='';
    generalReports.forEach((g,i)=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`<td>${i+1}</td>
        <td class="text-right">${window.escapeHtml(g.program)}</td>
        <td>${window.escapeHtml(g.type)}</td>
        <td>${window.escapeHtml(g.date)}</td>
        <td>${window.escapeHtml(g.count)}</td>
        <td class="text-right">${window.nl2brSafe(g.beneficiaries)}</td>
        <td class="text-right">${window.nl2brSafe(g.details)}</td>
        <td><button class="btn danger" style="width:auto;padding:4px 8px;font-size:.75rem;border-radius:999px;box-shadow:none;" onclick="deleteGeneral(${i})">Ø­Ø°Ù</button></td>`;
      body.appendChild(tr);
    });
  }

  window.deleteGeneral = function(i){
    if(!confirm('Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ±ØŸ')) return;
    generalReports.splice(i,1);
    generalPersist();
    renderGeneral();
    window.showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„ØªÙ‚Ø±ÙŠØ±');
  };

  function initGeneralForm(){
    document.getElementById('saveGeneralBtn').addEventListener('click', ()=>{
      const program=document.getElementById('gProgram').value.trim();
      const executor=document.getElementById('gExecutor').value.trim();
      const location=document.getElementById('gLocation').value.trim();
      const type=document.getElementById('gType').value;
      const date=document.getElementById('gDate').value.trim();
      const count=document.getElementById('gCount').value.trim();
      const beneficiaries=document.getElementById('gBeneficiaries').value.trim();
      const details=document.getElementById('gDetails').value.trim();

      if(!program||!executor||!location||!type||!date||!count||!beneficiaries||!details){
        window.showToast('Ø£ÙƒÙ…Ù„ÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„','warn');
        return;
      }

      generalReports.push({program,executor,location,type,date,count,beneficiaries,details});
      generalPersist();
      renderGeneral();
      document.getElementById('generalForm').reset();
      window.showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±');
    });

    document.getElementById('clearGeneralBtn').addEventListener('click', ()=>{
      if(!generalReports.length){window.showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø³Ø¬Ù„Ø©','warn');return;}
      if(!confirm('Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ø§Ù…ØŸ')) return;
      generalReports=[];
      localStorage.removeItem(GEN_KEY);
      renderGeneral();
      window.showToast('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±');
    });

    document.getElementById('exportGeneralBtn').addEventListener('click', async ()=>{
      if(!generalReports.length){window.showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø³Ø¬Ù„Ø©','warn');return;}
      window.showToast('Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ù…Ù„Ù PDF...','warn');

      const JsPDF=getJsPDF();
      const pdf=new JsPDF({orientation:'portrait',unit:'mm',format:'a4'});
      const pageWidth=pdf.internal.pageSize.getWidth();

      for(let i=0;i<generalReports.length;i++){
        const rep=generalReports[i];

        const printDiv=document.createElement('div');
        printDiv.style.cssText="position:absolute;left:-10000px;top:0;width:794px;background:#fff;padding:40px 40px 30px;direction:rtl;font-family:'Tajawal',sans-serif;font-size:15px;";

        printDiv.innerHTML=`
          <div style="text-align:center;margin-bottom:18px;">
            <img src="https://raw.githubusercontent.com/omymh/school26/main/26.png"
                 crossorigin="anonymous"
                 style="width:100%;height:70px;object-fit:contain;margin-bottom:8px;">
            <div style="font-weight:900;font-size:18px;margin-top:4px;">ØªÙ‚Ø±ÙŠØ± Ø¹Ø§Ù… Ù„ØªÙ†ÙÙŠØ° Ø¨Ø±Ù†Ø§Ù…Ø¬ / Ù†Ø´Ø§Ø·</div>
            <div style="margin-top:10px;font-size:15px;font-weight:900;">
              Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±: <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(rep.type||'')}</span>
            </div>
            <div style="margin-top:6px;font-size:15px;font-weight:900;">
              Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ / Ø§Ù„Ù†Ø´Ø§Ø·: <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(rep.program||'')}</span>
            </div>
          </div>

          <div style="border:1px solid #bbf7d0;border-radius:12px;padding:18px 14px;line-height:2;">
            <div style="font-size:15px;font-weight:900;margin-bottom:4px;">
              Ø§Ù„Ù…Ù†ÙØ° / Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ù†ÙØ°Ø©:
              <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(rep.executor||'')}</span>
            </div>

            <div style="font-size:15px;font-weight:900;margin-bottom:4px;">
              Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°:
              <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(rep.location||'')}</span>
            </div>

            <div style="font-size:15px;font-weight:900;margin-bottom:4px;">
              Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙŠÙ†:
              <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(rep.count||'')}</span>
            </div>

            <div style="font-size:15px;font-weight:900;margin:12px 0 6px;">Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙÙŠØ¯Ø©:</div>
            <div style="border:1px solid #bbf7d0;border-radius:10px;padding:10px 12px;background:#f8fffb;
                        font-size:15px;font-weight:500;line-height:1.9;text-align:right;direction:rtl;unicode-bidi:plaintext;white-space:pre-wrap;">
              ${window.nl2brSafe(rep.beneficiaries||'')}
            </div>

            <div style="font-size:15px;font-weight:900;margin-top:12px;">
              ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°:
              <span style="font-weight:500;padding-right:6px;">${window.escapeHtml(rep.date||'')} Ù‡Ù€</span>
            </div>

            <hr style="border:none;border-top:1px dashed #bbf7d0;margin:14px 0;">

            <div style="font-size:15px;font-weight:900;margin:12px 0 6px;">Ø£Ø¨Ø±Ø² Ù…Ø§ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡:</div>
            <div style="border:1px solid #bbf7d0;border-radius:10px;padding:10px 12px;background:#f8fffb;
                        font-size:15px;font-weight:500;line-height:1.9;text-align:right;direction:rtl;unicode-bidi:plaintext;white-space:pre-wrap;">
              ${window.nl2brSafe(rep.details||'')}
            </div>
          </div>

          <div style="margin-top:22px;padding-top:10px;border-top:1px solid #bbf7d0;">
            <div style="display:flex;justify-content:flex-start;direction:ltr;">
              <div style="text-align:left;">
                <p style="margin:0 0 3px;font-weight:bold;color:#047857;font-size:14px;">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</p>
                <p style="margin:0;font-size:14px;color:#047857;">Ø£Ù…Ø§Ù†ÙŠ Ø¢Ù„ Ø¹Ø¨Ø´Ø§Ù†</p>
              </div>
            </div>
          </div>
        `;

        document.body.appendChild(printDiv);
        const canvas=await captureAsCanvas(printDiv);
        printDiv.remove();

        const imgData=canvas.toDataURL('image/jpeg',0.92);
        const imgWidth=pageWidth;
        const imgHeight=(canvas.height*imgWidth)/canvas.width;

        if(i>0) pdf.addPage();
        pdf.addImage(imgData,'JPEG',0,0,imgWidth,imgHeight);
      }

      pdf.save('Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¹Ø§Ù…Ø©.pdf');
      window.showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ù…Ù„Ù PDF');
    });
  }

  // ============================================================================
  // Hijri calendar (Ù…Ø¨Ø³Ø·)
  // ============================================================================

  let currentHijriYear=1447,currentHijriMonth=1;
  const HIJRI_MONTH_NAMES=['Ù…Ø­Ø±Ù…','ØµÙØ±','Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„','Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø¢Ø®Ø±','Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø£ÙˆÙ„Ù‰','Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø¢Ø®Ø±Ø©','Ø±Ø¬Ø¨','Ø´Ø¹Ø¨Ø§Ù†','Ø±Ù…Ø¶Ø§Ù†','Ø´ÙˆØ§Ù„','Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©','Ø°Ùˆ Ø§Ù„Ø­Ø¬Ø©'];

  function getTodayHijri(){
    const t=new Date();
    return `1447/${t.getMonth()+1}/${t.getDate()}`;
  }

  function renderHijriCalendar(calendar,input){
    calendar.associatedInput=input;
    const monthYear=calendar.querySelector('.hijri-month-year');
    const daysContainer=calendar.querySelector('.hijri-days');

    monthYear.textContent=HIJRI_MONTH_NAMES[currentHijriMonth-1]+' '+currentHijriYear;
    const daysInMonth=30;

    let html='';
    for(let d=1;d<=daysInMonth;d++) html+=`<div class="hijri-day">${d}</div>`;
    daysContainer.innerHTML=html;

    daysContainer.querySelectorAll('.hijri-day').forEach(day=>{
      day.onclick=function(){
        const val=`${currentHijriYear}/${currentHijriMonth}/${this.textContent}`;
        input.value=val;
        calendar.classList.remove('active');
        window.showToast('ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ®');
      };
    });
  }

  function initHijriCalendars(){
    const hijriInputs=document.querySelectorAll('.hijri-date-input');
    const calendars=document.querySelectorAll('.hijri-calendar');

    hijriInputs.forEach((input,idx)=>{
      const calendar=calendars[idx];
      const toggle=input.parentElement.querySelector('.hijri-toggle');

      toggle.addEventListener('click',e=>{
        e.preventDefault();e.stopPropagation();
        calendars.forEach(c=>c.classList.remove('active'));
        calendar.classList.toggle('active');
        if(calendar.classList.contains('active')) renderHijriCalendar(calendar,input);
      });

      document.addEventListener('click',e=>{
        if(!calendar.contains(e.target) && e.target!==toggle) calendar.classList.remove('active');
      });
      calendar.addEventListener('click',e=>e.stopPropagation());

      const prevYear=calendar.querySelector('.prev-year');
      const prevMonth=calendar.querySelector('.prev-month');
      const nextMonth=calendar.querySelector('.next-month');
      const nextYear=calendar.querySelector('.next-year');
      const todayBtn=calendar.querySelector('.today-btn');

      prevYear.onclick=()=>{currentHijriYear--;renderHijriCalendar(calendar,input);};
      nextYear.onclick=()=>{currentHijriYear++;renderHijriCalendar(calendar,input);};
      prevMonth.onclick=()=>{
        currentHijriMonth--;
        if(currentHijriMonth<1){currentHijriMonth=12;currentHijriYear--;}
        renderHijriCalendar(calendar,input);
      };
      nextMonth.onclick=()=>{
        currentHijriMonth++;
        if(currentHijriMonth>12){currentHijriMonth=1;currentHijriYear++;}
        renderHijriCalendar(calendar,input);
      };
      todayBtn.onclick=()=>{input.value=getTodayHijri();calendar.classList.remove('active');window.showToast('ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…');};
    });
  }

  // ============================================================================
  // Init
  // ============================================================================

  function initializeApp(){
    waitLoad();
    initWaitForm();

    labLoad();
    initLabForm();

    generalLoad();
    initGeneralForm();

    initHijriCalendars();
  }

  document.addEventListener('DOMContentLoaded', initializeApp);
</script>

</body>
</html>
